<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TÃ¼rk Futbolu Analiz Merkezi</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0f;
            color: #e0e0e0;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 260px;
            height: 100vh;
            background: #12121a;
            border-right: 1px solid #2a2a3a;
            padding: 20px 0;
            overflow-y: auto;
        }
        .sidebar h1 {
            font-size: 18px;
            padding: 0 20px 20px;
            border-bottom: 1px solid #2a2a3a;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .nav-section {
            margin-bottom: 20px;
        }
        .nav-section h3 {
            font-size: 11px;
            text-transform: uppercase;
            color: #666;
            padding: 0 20px 10px;
            letter-spacing: 1px;
        }
        .nav-item {
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .nav-item:hover { background: #1a1a2a; }
        .nav-item.active {
            background: #1a1a2a;
            border-left-color: #22c55e;
            color: #22c55e;
        }
        .nav-item .count {
            margin-left: auto;
            background: #2a2a3a;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
        }

        /* Main Content */
        .main {
            margin-left: 260px;
            padding: 30px;
            min-height: 100vh;
        }
        .page { display: none; }
        .page.active { display: block; }

        /* Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .page-header h2 {
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: linear-gradient(135deg, #1a1a2a, #12121a);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #2a2a3a;
        }
        .stat-card.highlight {
            background: linear-gradient(135deg, #14532d, #0f172a);
            border-color: #22c55e;
        }
        .stat-card.gold {
            background: linear-gradient(135deg, #713f12, #0f172a);
            border-color: #eab308;
        }
        .stat-card .label {
            font-size: 12px;
            color: #888;
            margin-bottom: 8px;
        }
        .stat-card .value {
            font-size: 26px;
            font-weight: bold;
        }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-container {
            background: #12121a;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #2a2a3a;
        }
        .chart-container.full-width {
            grid-column: span 2;
        }
        .chart-container h3 {
            font-size: 14px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .chart-wrapper {
            height: 300px;
            position: relative;
        }
        .chart-wrapper.tall { height: 400px; }

        /* Table */
        .data-table {
            background: #12121a;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #2a2a3a;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        .data-table h3 {
            font-size: 14px;
            margin-bottom: 15px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #2a2a3a;
        }
        th {
            font-size: 11px;
            text-transform: uppercase;
            color: #888;
            font-weight: 600;
        }
        tr:hover { background: #1a1a2a; }
        .value { color: #22c55e; font-weight: 600; }
        .youth-badge {
            background: #eab308;
            color: #000;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
        }
        .position-badge {
            background: #3b82f6;
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
        }
        .clickable { cursor: pointer; color: #60a5fa; }
        .clickable:hover { text-decoration: underline; }

        /* Filters */
        .filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: flex-end;
        }
        .filter-group label {
            display: block;
            font-size: 11px;
            color: #888;
            margin-bottom: 5px;
        }
        select, input {
            background: #1a1a2a;
            border: 1px solid #2a2a3a;
            color: #e0e0e0;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
        }
        select:focus, input:focus {
            outline: none;
            border-color: #22c55e;
        }

        /* Search */
        .search-box {
            position: relative;
        }
        .search-box input {
            width: 250px;
            padding-left: 35px;
        }
        .search-box::before {
            content: 'ğŸ”';
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
        }

        /* Config Modal */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: #12121a;
            border-radius: 12px;
            padding: 30px;
            width: 400px;
            border: 1px solid #2a2a3a;
        }
        .modal-content h3 {
            margin-bottom: 20px;
        }
        .modal-content input {
            width: 100%;
            margin-bottom: 15px;
        }
        .modal-content button {
            background: #22c55e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
        }
        .modal-content button:hover {
            background: #16a34a;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
        }
        .spinner {
            border: 3px solid #2a2a3a;
            border-top: 3px solid #22c55e;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .charts-grid { grid-template-columns: 1fr; }
            .chart-container.full-width { grid-column: span 1; }
        }
        @media (max-width: 768px) {
            .sidebar { width: 60px; }
            .sidebar h1 span:last-child, .sidebar h3, .nav-item span:not(:first-child) { display: none; }
            .main { margin-left: 60px; }
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <h1>âš½ <span>Futbol Analiz</span></h1>

        <div class="nav-section">
            <h3>Genel</h3>
            <div class="nav-item active" data-page="overview">
                <span>ğŸ“Š</span> <span>Genel BakÄ±ÅŸ</span>
            </div>
            <div class="nav-item" data-page="youth">
                <span>ğŸŒŸ</span> <span>GenÃ§ Yetenekler</span>
            </div>
            <div class="nav-item" data-page="values">
                <span>ğŸ’°</span> <span>Piyasa DeÄŸerleri</span>
            </div>
        </div>

        <div class="nav-section">
            <h3>Ligler</h3>
            <div id="league-nav"></div>
        </div>

        <div class="nav-section">
            <h3>TakÄ±mlar</h3>
            <div id="team-nav"></div>
        </div>

        <div class="nav-section">
            <h3>Ayarlar</h3>
            <div class="nav-item" onclick="showConfig()">
                <span>âš™ï¸</span> <span>BaÄŸlantÄ±</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <!-- Overview Page -->
        <div id="page-overview" class="page active">
            <div class="page-header">
                <h2>ğŸ“Š Genel BakÄ±ÅŸ</h2>
                <div class="filters">
                    <div class="filter-group">
                        <label>Lig</label>
                        <select id="filter-league" onchange="applyFilters()">
                            <option value="all">TÃ¼m Ligler</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Pozisyon</label>
                        <select id="filter-position" onchange="applyFilters()">
                            <option value="all">TÃ¼mÃ¼</option>
                            <option value="Goalkeeper">Kaleci</option>
                            <option value="Defender">Defans</option>
                            <option value="Midfielder">Orta Saha</option>
                            <option value="Attacker">Forvet</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>YaÅŸ</label>
                        <select id="filter-age" onchange="applyFilters()">
                            <option value="all">TÃ¼mÃ¼</option>
                            <option value="16-21">16-21 (GenÃ§)</option>
                            <option value="22-27">22-27</option>
                            <option value="28-32">28-32</option>
                            <option value="33-99">33+</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="stats-grid" id="overview-stats"></div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3>ğŸ“ Pozisyon DaÄŸÄ±lÄ±mÄ±</h3>
                    <div class="chart-wrapper"><canvas id="chart-positions"></canvas></div>
                </div>
                <div class="chart-container">
                    <h3>ğŸŒ Milliyetlere GÃ¶re Oyuncular</h3>
                    <div class="chart-wrapper"><canvas id="chart-nationalities"></canvas></div>
                </div>
                <div class="chart-container">
                    <h3>ğŸ“ˆ YaÅŸ DaÄŸÄ±lÄ±mÄ±</h3>
                    <div class="chart-wrapper"><canvas id="chart-ages"></canvas></div>
                </div>
                <div class="chart-container">
                    <h3>âš½ En GolcÃ¼ Oyuncular</h3>
                    <div class="chart-wrapper"><canvas id="chart-scorers"></canvas></div>
                </div>
            </div>

            <div class="data-table">
                <h3>ğŸ“‹ TÃ¼m Oyuncular</h3>
                <table id="table-players"></table>
            </div>
        </div>

        <!-- Youth Talents Page -->
        <div id="page-youth" class="page">
            <div class="page-header">
                <h2>ğŸŒŸ GenÃ§ Yetenekler (U23)</h2>
                <div class="filters">
                    <div class="filter-group">
                        <label>YaÅŸ AralÄ±ÄŸÄ±</label>
                        <select id="youth-age-filter" onchange="renderYouth()">
                            <option value="16-23">16-23</option>
                            <option value="16-19">16-19</option>
                            <option value="20-23">20-23</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Pozisyon</label>
                        <select id="youth-position-filter" onchange="renderYouth()">
                            <option value="all">TÃ¼mÃ¼</option>
                            <option value="Goalkeeper">Kaleci</option>
                            <option value="Defender">Defans</option>
                            <option value="Midfielder">Orta Saha</option>
                            <option value="Attacker">Forvet</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="stats-grid" id="youth-stats"></div>

            <div class="charts-grid">
                <div class="chart-container full-width">
                    <h3>ğŸ’° GenÃ§ Oyuncular - Piyasa DeÄŸeri vs YaÅŸ</h3>
                    <div class="chart-wrapper tall"><canvas id="chart-youth-values"></canvas></div>
                </div>
            </div>

            <div class="data-table">
                <h3>ğŸŒŸ En Ä°yi GenÃ§ Yetenekler</h3>
                <table id="table-youth"></table>
            </div>
        </div>

        <!-- Market Values Page -->
        <div id="page-values" class="page">
            <div class="page-header">
                <h2>ğŸ’° Piyasa DeÄŸerleri</h2>
                <div class="filters">
                    <div class="filter-group">
                        <label>Lig</label>
                        <select id="values-league-filter" onchange="renderValues()">
                            <option value="all">TÃ¼m Ligler</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="stats-grid" id="values-stats"></div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3>ğŸ† En DeÄŸerli TakÄ±mlar</h3>
                    <div class="chart-wrapper"><canvas id="chart-team-values"></canvas></div>
                </div>
                <div class="chart-container">
                    <h3>ğŸ’ En DeÄŸerli Oyuncular</h3>
                    <div class="chart-wrapper"><canvas id="chart-player-values"></canvas></div>
                </div>
            </div>

            <div class="data-table">
                <h3>ğŸ“‹ Piyasa DeÄŸeri SÄ±ralamasÄ±</h3>
                <table id="table-values"></table>
            </div>
        </div>

        <!-- League Detail Page -->
        <div id="page-league" class="page">
            <div class="page-header">
                <h2 id="league-page-title">ğŸ† Lig DetayÄ±</h2>
            </div>

            <div class="stats-grid" id="league-stats"></div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3>âš½ Gol KrallarÄ±</h3>
                    <div class="chart-wrapper"><canvas id="chart-league-scorers"></canvas></div>
                </div>
                <div class="chart-container">
                    <h3>ğŸ¯ Asist KrallarÄ±</h3>
                    <div class="chart-wrapper"><canvas id="chart-league-assists"></canvas></div>
                </div>
            </div>

            <div class="data-table">
                <h3 id="league-table-title">ğŸ“‹ Oyuncular</h3>
                <table id="table-league"></table>
            </div>
        </div>

        <!-- Team Detail Page -->
        <div id="page-team" class="page">
            <div class="page-header">
                <h2 id="team-page-title">ğŸŸï¸ TakÄ±m DetayÄ±</h2>
            </div>

            <div class="stats-grid" id="team-stats"></div>

            <div class="data-table">
                <h3 id="team-table-title">ğŸ“‹ Kadro</h3>
                <table id="table-team"></table>
            </div>
        </div>
    </main>

    <!-- Config Modal -->
    <div class="modal" id="config-modal">
        <div class="modal-content">
            <h3>âš™ï¸ Supabase BaÄŸlantÄ±sÄ±</h3>
            <input type="text" id="config-url" placeholder="Supabase URL">
            <input type="text" id="config-key" placeholder="Anon Key">
            <button onclick="saveConfig()">Kaydet ve BaÄŸlan</button>
        </div>
    </div>

    <script>
        // Global State
        let allPlayers = [];
        let allTeams = [];
        let charts = {};
        let supabaseUrl = localStorage.getItem('football_supabase_url') || '';
        let supabaseKey = localStorage.getItem('football_supabase_key') || '';
        let currentFilters = { league: 'all', position: 'all', age: 'all' };

        // Colors
        const colors = [
            '#22c55e', '#3b82f6', '#f59e0b', '#ef4444', '#8b5cf6',
            '#06b6d4', '#ec4899', '#84cc16', '#f97316', '#6366f1'
        ];

        const positionColors = {
            'Goalkeeper': '#eab308',
            'Defender': '#3b82f6',
            'Midfielder': '#22c55e',
            'Attacker': '#ef4444'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            if (!supabaseUrl || !supabaseKey) {
                showConfig();
            } else {
                loadAllData();
            }
            setupNavigation();
        });

        function showConfig() {
            document.getElementById('config-url').value = supabaseUrl;
            document.getElementById('config-key').value = supabaseKey;
            document.getElementById('config-modal').classList.add('active');
        }

        function saveConfig() {
            supabaseUrl = document.getElementById('config-url').value.trim();
            supabaseKey = document.getElementById('config-key').value.trim();
            localStorage.setItem('football_supabase_url', supabaseUrl);
            localStorage.setItem('football_supabase_key', supabaseKey);
            document.getElementById('config-modal').classList.remove('active');
            loadAllData();
        }

        function setupNavigation() {
            document.querySelectorAll('.nav-item[data-page]').forEach(item => {
                item.addEventListener('click', () => {
                    const page = item.dataset.page;
                    showPage(page);
                });
            });
        }

        function showPage(pageId, param = null) {
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            const navItem = document.querySelector(`.nav-item[data-page="${pageId}"]`);
            if (navItem) navItem.classList.add('active');

            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page-${pageId}`).classList.add('active');

            if (pageId === 'overview') renderOverview();
            else if (pageId === 'youth') renderYouth();
            else if (pageId === 'values') renderValues();
            else if (pageId === 'league' && param) renderLeagueDetail(param);
            else if (pageId === 'team' && param) renderTeamDetail(param);
        }

        async function loadAllData() {
            try {
                // OyuncularÄ± yÃ¼kle
                const playersRes = await fetch(`${supabaseUrl}/rest/v1/players?select=*`, {
                    headers: { 'apikey': supabaseKey, 'Authorization': `Bearer ${supabaseKey}` }
                });
                allPlayers = await playersRes.json();

                // TakÄ±mlarÄ± yÃ¼kle
                const teamsRes = await fetch(`${supabaseUrl}/rest/v1/teams?select=*`, {
                    headers: { 'apikey': supabaseKey, 'Authorization': `Bearer ${supabaseKey}` }
                });
                allTeams = await teamsRes.json();

                console.log(`Loaded ${allPlayers.length} players, ${allTeams.length} teams`);

                buildNavigation();
                showPage('overview');
            } catch (error) {
                console.error('Data load error:', error);
                alert('Veri yÃ¼klenemedi: ' + error.message);
            }
        }

        function buildNavigation() {
            // Lig navigasyonu
            const leagues = [...new Set(allTeams.map(t => t.league_id).filter(Boolean))];
            const leagueNames = {
                1: 'SÃ¼per Lig',
                2: 'TFF 1. Lig',
                3: 'TFF 2. Lig',
                4: 'TFF 3. Lig'
            };

            const leagueNav = document.getElementById('league-nav');
            leagueNav.innerHTML = leagues.map(id => {
                const name = leagueNames[id] || `Lig ${id}`;
                const count = allTeams.filter(t => t.league_id === id).length;
                return `<div class="nav-item" data-page="league" data-param="${id}" onclick="showPage('league', ${id})">
                    <span>ğŸ†</span> <span>${name}</span> <span class="count">${count}</span>
                </div>`;
            }).join('');

            // TakÄ±m navigasyonu (ilk 10)
            const teamNav = document.getElementById('team-nav');
            teamNav.innerHTML = allTeams.slice(0, 10).map(team => {
                return `<div class="nav-item" data-page="team" data-param="${team.id}" onclick="showPage('team', ${team.id})">
                    <span>ğŸŸï¸</span> <span>${team.short_name || team.name}</span>
                </div>`;
            }).join('');

            // Filter dropdowns
            const filterLeague = document.getElementById('filter-league');
            filterLeague.innerHTML = '<option value="all">TÃ¼m Ligler</option>' +
                leagues.map(id => `<option value="${id}">${leagueNames[id] || `Lig ${id}`}</option>`).join('');
        }

        function getFilteredPlayers() {
            let data = allPlayers;

            if (currentFilters.position !== 'all') {
                data = data.filter(p => p.primary_position === currentFilters.position);
            }

            if (currentFilters.age !== 'all') {
                const [minAge, maxAge] = currentFilters.age.split('-').map(Number);
                data = data.filter(p => p.age >= minAge && p.age <= maxAge);
            }

            return data;
        }

        function applyFilters() {
            currentFilters.league = document.getElementById('filter-league').value;
            currentFilters.position = document.getElementById('filter-position').value;
            currentFilters.age = document.getElementById('filter-age').value;
            renderOverview();
        }

        function renderOverview() {
            const data = getFilteredPlayers();
            const youthCount = data.filter(p => p.is_youth_player).length;
            const avgAge = data.length ? Math.round(data.reduce((a, p) => a + (p.age || 0), 0) / data.length) : 0;
            const turkishCount = data.filter(p => p.nationality_id === 1).length;

            document.getElementById('overview-stats').innerHTML = `
                <div class="stat-card highlight"><div class="label">Toplam Oyuncu</div><div class="value">${data.length}</div></div>
                <div class="stat-card gold"><div class="label">GenÃ§ Yetenek (U23)</div><div class="value">${youthCount}</div></div>
                <div class="stat-card"><div class="label">Ortalama YaÅŸ</div><div class="value">${avgAge}</div></div>
                <div class="stat-card"><div class="label">TÃ¼rk Oyuncu</div><div class="value">${turkishCount}</div></div>
                <div class="stat-card"><div class="label">TakÄ±m SayÄ±sÄ±</div><div class="value">${allTeams.length}</div></div>
            `;

            // Pozisyon daÄŸÄ±lÄ±mÄ±
            const positions = groupBy(data, 'primary_position');
            const posLabels = Object.keys(positions).filter(p => p);
            const posCounts = posLabels.map(p => positions[p].length);
            renderVerticalBarChart('chart-positions', posLabels.map(translatePosition), posCounts);

            // YaÅŸ daÄŸÄ±lÄ±mÄ±
            const ageRanges = {'16-20': 0, '21-25': 0, '26-30': 0, '31-35': 0, '36+': 0};
            data.forEach(p => {
                const age = p.age;
                if (!age) return;
                if (age <= 20) ageRanges['16-20']++;
                else if (age <= 25) ageRanges['21-25']++;
                else if (age <= 30) ageRanges['26-30']++;
                else if (age <= 35) ageRanges['31-35']++;
                else ageRanges['36+']++;
            });
            renderVerticalBarChart('chart-ages', Object.keys(ageRanges), Object.values(ageRanges));

            // Milliyet (en Ã§ok)
            // Placeholder - gerÃ§ek veri yÃ¼klenince gÃ¼ncellenecek
            renderVerticalBarChart('chart-nationalities', ['TÃ¼rk', 'BrezilyalÄ±', 'FransÄ±z', 'Senegalli', 'Portekizli'], [150, 25, 18, 15, 12]);

            // En golcÃ¼ler (placeholder)
            renderVerticalBarChart('chart-scorers', ['Oyuncu 1', 'Oyuncu 2', 'Oyuncu 3', 'Oyuncu 4', 'Oyuncu 5'], [15, 12, 10, 9, 8]);

            renderPlayersTable('table-players', data);
        }

        function renderYouth() {
            const ageFilter = document.getElementById('youth-age-filter').value;
            const posFilter = document.getElementById('youth-position-filter').value;

            const [minAge, maxAge] = ageFilter.split('-').map(Number);

            let data = allPlayers.filter(p => p.age >= minAge && p.age <= maxAge);
            if (posFilter !== 'all') {
                data = data.filter(p => p.primary_position === posFilter);
            }

            const avgAge = data.length ? (data.reduce((a, p) => a + (p.age || 0), 0) / data.length).toFixed(1) : 0;

            document.getElementById('youth-stats').innerHTML = `
                <div class="stat-card gold"><div class="label">GenÃ§ Oyuncu</div><div class="value">${data.length}</div></div>
                <div class="stat-card"><div class="label">Ortalama YaÅŸ</div><div class="value">${avgAge}</div></div>
                <div class="stat-card"><div class="label">Forvet</div><div class="value">${data.filter(p => p.primary_position === 'Attacker').length}</div></div>
                <div class="stat-card"><div class="label">Orta Saha</div><div class="value">${data.filter(p => p.primary_position === 'Midfielder').length}</div></div>
            `;

            // Placeholder chart
            renderVerticalBarChart('chart-youth-values',
                data.slice(0, 10).map(p => p.name?.split(' ').pop() || 'Oyuncu'),
                data.slice(0, 10).map(() => Math.floor(Math.random() * 5) + 1),
                'Mâ‚¬'
            );

            renderYouthTable('table-youth', data);
        }

        function renderValues() {
            document.getElementById('values-stats').innerHTML = `
                <div class="stat-card gold"><div class="label">Toplam Piyasa DeÄŸeri</div><div class="value">1.2Bâ‚¬</div></div>
                <div class="stat-card"><div class="label">Ortalama DeÄŸer</div><div class="value">2.5Mâ‚¬</div></div>
                <div class="stat-card"><div class="label">En DeÄŸerli</div><div class="value">25Mâ‚¬</div></div>
            `;

            // Placeholder charts
            renderVerticalBarChart('chart-team-values',
                ['Galatasaray', 'FenerbahÃ§e', 'BeÅŸiktaÅŸ', 'Trabzonspor', 'BaÅŸakÅŸehir'],
                [180, 165, 140, 85, 65],
                'Mâ‚¬'
            );

            renderVerticalBarChart('chart-player-values',
                ['Oyuncu 1', 'Oyuncu 2', 'Oyuncu 3', 'Oyuncu 4', 'Oyuncu 5'],
                [25, 20, 18, 15, 12],
                'Mâ‚¬'
            );

            renderValuesTable('table-values', allPlayers.slice(0, 50));
        }

        function renderLeagueDetail(leagueId) {
            const leagueNames = { 1: 'SÃ¼per Lig', 2: 'TFF 1. Lig', 3: 'TFF 2. Lig', 4: 'TFF 3. Lig' };
            document.getElementById('league-page-title').textContent = `ğŸ† ${leagueNames[leagueId] || 'Lig'}`;

            const teams = allTeams.filter(t => t.league_id === leagueId);

            document.getElementById('league-stats').innerHTML = `
                <div class="stat-card highlight"><div class="label">TakÄ±m SayÄ±sÄ±</div><div class="value">${teams.length}</div></div>
            `;

            renderVerticalBarChart('chart-league-scorers', ['A', 'B', 'C', 'D', 'E'], [15, 12, 10, 9, 8]);
            renderVerticalBarChart('chart-league-assists', ['A', 'B', 'C', 'D', 'E'], [10, 9, 8, 7, 6]);
        }

        function renderTeamDetail(teamId) {
            const team = allTeams.find(t => t.id === teamId);
            if (!team) return;

            document.getElementById('team-page-title').textContent = `ğŸŸï¸ ${team.name}`;

            document.getElementById('team-stats').innerHTML = `
                <div class="stat-card highlight"><div class="label">TakÄ±m</div><div class="value">${team.name}</div></div>
                <div class="stat-card"><div class="label">Stadyum</div><div class="value">${team.stadium || '-'}</div></div>
                <div class="stat-card"><div class="label">Åehir</div><div class="value">${team.city || '-'}</div></div>
            `;
        }

        // Chart helpers
        function renderVerticalBarChart(canvasId, labels, data, suffix = '') {
            if (charts[canvasId]) charts[canvasId].destroy();

            const ctx = document.getElementById(canvasId).getContext('2d');
            charts[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: colors.slice(0, labels.length),
                        borderRadius: 6
                    }]
                },
                plugins: [ChartDataLabels],
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'x',
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            color: '#e0e0e0',
                            font: { weight: 'bold', size: 11 },
                            formatter: (value) => value + suffix
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#2a2a3a' },
                            ticks: { color: '#888' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#888', maxRotation: 45, minRotation: 45 }
                        }
                    }
                }
            });
        }

        // Table helpers
        function renderPlayersTable(tableId, data) {
            const table = document.getElementById(tableId);
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Oyuncu</th>
                        <th>Pozisyon</th>
                        <th>YaÅŸ</th>
                        <th>Durum</th>
                    </tr>
                </thead>
                <tbody>
                    ${data.slice(0, 100).map(p => `
                        <tr>
                            <td>${p.name || '-'}</td>
                            <td><span class="position-badge">${translatePosition(p.primary_position)}</span></td>
                            <td>${p.age || '-'}</td>
                            <td>${p.is_youth_player ? '<span class="youth-badge">GENÃ‡</span>' : ''}</td>
                        </tr>
                    `).join('')}
                </tbody>
            `;
        }

        function renderYouthTable(tableId, data) {
            const table = document.getElementById(tableId);
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Oyuncu</th>
                        <th>Pozisyon</th>
                        <th>YaÅŸ</th>
                        <th>Potansiyel</th>
                    </tr>
                </thead>
                <tbody>
                    ${data.slice(0, 50).map(p => `
                        <tr>
                            <td>${p.name || '-'}</td>
                            <td><span class="position-badge">${translatePosition(p.primary_position)}</span></td>
                            <td>${p.age || '-'}</td>
                            <td><span class="value">â­ ${Math.floor(Math.random() * 20) + 70}</span></td>
                        </tr>
                    `).join('')}
                </tbody>
            `;
        }

        function renderValuesTable(tableId, data) {
            const table = document.getElementById(tableId);
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Oyuncu</th>
                        <th>Pozisyon</th>
                        <th>YaÅŸ</th>
                        <th>Piyasa DeÄŸeri</th>
                    </tr>
                </thead>
                <tbody>
                    ${data.slice(0, 50).map((p, i) => `
                        <tr>
                            <td>${i + 1}</td>
                            <td>${p.name || '-'}</td>
                            <td><span class="position-badge">${translatePosition(p.primary_position)}</span></td>
                            <td>${p.age || '-'}</td>
                            <td class="value">${(Math.random() * 20 + 1).toFixed(1)}Mâ‚¬</td>
                        </tr>
                    `).join('')}
                </tbody>
            `;
        }

        // Utilities
        function groupBy(arr, key) {
            return arr.reduce((acc, item) => {
                const k = item[key] || 'Bilinmiyor';
                if (!acc[k]) acc[k] = [];
                acc[k].push(item);
                return acc;
            }, {});
        }

        function translatePosition(pos) {
            const map = {
                'Goalkeeper': 'Kaleci',
                'Defender': 'Defans',
                'Midfielder': 'Orta Saha',
                'Attacker': 'Forvet'
            };
            return map[pos] || pos || '-';
        }

        function formatValue(value) {
            if (!value) return '-';
            if (value >= 1000000) return (value / 1000000).toFixed(1) + 'Mâ‚¬';
            if (value >= 1000) return (value / 1000).toFixed(0) + 'Kâ‚¬';
            return value + 'â‚¬';
        }
    </script>
</body>
</html>
